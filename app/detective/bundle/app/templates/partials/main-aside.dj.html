<aside class="main-aside" ng-controller="MainAsideCtrl">
    <h1 class="main-aside__title">
        <a ui-sref="home.tour" class="main-aside__title__caption" ng-if="!user.is_logged">
            Home
        </a>
        <a ui-sref="home.dashboard" class="main-aside__title__caption" ng-if="user.is_logged">
            Dashboard
        </a>
        <a class="main-aside__title__toggle-aside visible-xs" ng-click="Page.showAside = !Page.showAside">
            <i class="fa fa-bars"></i>
        </a>
    </h1>
    <div scrollable class="main-aside__wrapper">

        <div class="main-aside__current-topic" ng-if="topicsFactory.topic.slug">
            <h3>
                <a href="[[topicsFactory.topic.link]]" class="main-aside__current-topic__title">
                    <i class="fa fa-home"></i>
                    [[topicsFactory.topic.title]]
                </a>
                <div class="main-aside__current-topic__author">
                    by
                    <a ui-sref="user({username: topicsFactory.topic.author.username})">
                        [[topicsFactory.topic.author.username]]
                    </a>
                </div>
            </h3>
            <ul class="main-aside__current-topic__taxonomy list-unstyled">
                <li ng-repeat="model in topicsFactory.topic.models | filter:{is_searchable: true} | orderBy:'index'">
                    <a href="[[topicsFactory.topic.link]]/[[model.name|lowercase]]">
                        <div class="small" color-tag ref="model.name|lowercase"></div>
                        [[model.verbose_name]]
                    </a>
                </li>
            </ul>
        </div>

        <div class="main-aside__investigations-list" ng-if="user.is_logged && lasts.length">
            <h4>Your last investigations</h4>

            <div class="main-aside__investigations-list__topic" ng-repeat="group in lasts" ng-init="topic = group.topic" title="[[topic.title]]">
                <a ng-href="[[topic.link]]" class="fg"></a>
                <img ng-src="[[topic.thumbnail.medium]]" width="100%" class="bg" />
                <a ng-href="[[topic.link]]"  class="main-aside__investigations-list__topic__title">
                    [[topic.title|characters:30]]
                </a>
            </div>
        </div>

        <div class="main-aside__investigations-list">
            <h4>Featured investigations</h4>

            <div class="main-aside__investigations-list__topic" ng-repeat="topic in featured" title="[[topic.title]]">
                <a ng-href="[[topic.link]]" class="fg"></a>
                <img ng-src="[[topic.thumbnail.medium]]" width="100%" class="bg" />
                <a ng-href="[[topic.link]]"  class="main-aside__investigations-list__topic__title">
                    [[topic.title|characters:30]]
                </a>
            </div>
        </div>

    </div>
</aside>